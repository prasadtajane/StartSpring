package com.prasad.spring.persistence;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;

import com.prasad.spring.persistence.entity.Weather;

public class Tester {
	
	public static void main(String args[])	{
		
		EntityManagerFactory eMFactory = Persistence.createEntityManagerFactory("jpa-example");
		//Should be created only Once per database per connection
		//This is enough for DDL
		
		EntityManager eManagerInsert = eMFactory.createEntityManager();
		EntityManager eManagerSelect = eMFactory.createEntityManager();
		EntityManager eManagerUpdate = eMFactory.createEntityManager();
		EntityManager eManagerDelete = eMFactory.createEntityManager();
		//You can create as many entity manager as you want
		//This is required for the DML
		
		Weather wthr = new Weather();
		Weather wthr2 = new Weather();
		wthr.setCity("Chicago");
		wthr2.setCity("Chicago");
		wthr.setDescription("Its Dry today");
		wthr2.setDescription("Its Dry today");
		wthr.setHumidity(10);
		wthr2.setHumidity(10);
		wthr.setPressure(10);
		wthr2.setPressure(10);
		wthr.setTemperature(100);
		wthr2.setTemperature(100);
		//
		eManagerInsert.getTransaction().begin();
		eManagerInsert.persist(wthr); 			//This forces java to add the object in the database
		eManagerInsert.persist(wthr2);
		eManagerInsert.getTransaction().commit();	//By default the autoCommit property is set to 'false'
		//Without transaction begin and commit the persist is of no use.

		eManagerDelete.close();
		eManagerUpdate.close();
		eManagerSelect.close();
		eManagerInsert.close();
		
		eMFactory.close();
	}
}
